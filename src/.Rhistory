numericas_tratado = na.omit(numericas[-1])
correlation_matrix = cor(numericas_tratado)
num_vars_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$correlacionadas
num_vars_not_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$nao_correlacionadas %>% unlist
num_names_ordered = sapply(num_vars_correlated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_correlated = find_list_enough_vars_correlated(num_vars_correlated[num_names_ordered])
matrix_coef_contigency = calcule_multiple_coef_contigency(categoricas)
cat_vars_associated = part_variables_by_correlation(matrix_coef_contigency, valor_coef)$correlacionadas
cat_vars_not_associated = part_variables_by_correlation(matrix_coef_contigency, valor_coef)$nao_correlacionadas %>% unlist
cat_names_ordered = sapply(cat_vars_associated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_associated = find_list_enough_vars_correlated(cat_vars_associated[cat_names_ordered])
vec_enough_vars_associated_or_correlated = c(enough_vars_associated,enough_vars_correlated)
vec_vars_not_associated_or_correlated = c(cat_vars_not_associated, num_vars_not_correlated)
vec_util_vars = c(vec_vars_not_associated_or_correlated, vec_enough_vars_associated_or_correlated)
vec_num_vars_utils = c(enough_vars_correlated, num_vars_not_correlated)
vec_cat_vars_utils = c(enough_vars_associated, cat_vars_not_associated)
vec_num_vars_utils
df_treino %>%
select(vec_num_vars_utils)
knitr::opts_chunk$set(echo = F, message = F)
y
df_treino %>%
select(vec_num_vars_utils) %>%
cbind(y)
df_treino %>%
select(vec_num_vars_utils) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(vec_num_vars_utils[1:10]) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
enough_vars_correlated
df_treino %>%
select(enough_vars_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
vec_num_vars_utils = c(enough_vars_correlated, num_vars_not_correlated)
vec_cat_vars_utils = c(enough_vars_associated, cat_vars_not_associated)
df_treino %>%
select(enough_vars_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(num_vars_not_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
vec_cat_vars_utils = c(enough_vars_associated, cat_vars_not_associated)
df_treino %>%
select(cat_vars_not_associated) %>%
cbind(categoricas[1:6],y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(cat_vars_not_associated) %>%
cbind(y)
df_treino %>%
select(cat_vars_not_associated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
cat_vars_not_associated
df_treino %>%
select(enough_vars_associated)
df_treino %>%
select(enough_vars_associated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated) %>%
cbind(y) %>%
mutate(KitchenAbvGr = as.character(KitchenAbvGr))
df_treino %>%
select(enough_vars_associated) %>%
cbind(y) %>%
mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
length(enough_vars_associated)/2
df_treino %>%
select(enough_vars_associated[1:length(enough_vars_associated)/2]) %>%
cbind(y) %>%
mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated[1:length(enough_vars_associated)/2]) %>%
cbind(y) %>%
# mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated[1:6]) %>%
cbind(y) %>%
# mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated[6]) %>%
cbind(y) %>%
# mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated[7]) %>%
cbind(y) %>%
# mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
enough_vars_associated
df_treino %>%
select(enough_vars_associated[1]) %>%
cbind(y) %>%
# mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino['Neighborhood']
table(df_treino['Neighborhood'])
df_treino %>%
select(cat_vars_not_associated) %>%
cbind(y) %>%
# mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
T = 1
T
T == T
T == TRUE
TRUE = T
TRUE == T
T = TRUE
T = FALSE
T == TRUE
T == TRUE
df_treino %>%
select(cat_vars_not_associated) %>%
cbind(y) %>%
mutate(Fireplaces = as.character(Fireplaces)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
c(enough_vars_associated, cat_vars_not_associated)
df_treino %>%
select(cat_vars_not_associated) %>%
cbind(y) %>%
mutate(Fireplaces = as.character(Fireplaces)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
length(cat_vars_not_associated)
df_treino %>%
select(cat_vars_not_associated[1:6]) %>%
cbind(y) %>%
mutate(Fireplaces = as.character(Fireplaces)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(cat_vars_not_associated[7:12]) %>%
cbind(y) %>%
mutate(Fireplaces = as.character(Fireplaces)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(cat_vars_not_associated[7:11]) %>%
cbind(y) %>%
mutate(Fireplaces = as.character(Fireplaces)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(cat_vars_not_associated[1:6]) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated) %>%
cbind(y) %>%
mutate(KitchenAbvGr = as.character(KitchenAbvGr))
df_treino %>%
select(enough_vars_associated) %>%
cbind(y) %>%
mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
length(enough_vars_associated)
df_treino %>%
select(enough_vars_associated[1:5]) %>%
cbind(y) %>%
mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated[1:5]) %>%
cbind(y) %>%
mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_associated[1:5]) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(cat_vars_not_associated[1:6]) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(enough_vars_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(num_vars_not_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
data_num = cbind(df_treino[vec_num_vars_utils], y)
data_num
data_num = cbind(df_treino[vec_num_vars_utils])
sapply(numericas, function(x) round(cor.test(x,y)$p.value,5))
vec_num_vars_utils
sapply(data_num, function(x) round(cor(x,y)$p.value,5))
data_num = cbind(df_treino[vec_num_vars_utils])
sapply(data_num, function(x) round(cor(x,y)$p.value,5))
sapply(data_num, function(x) round(cor(as.numeric(x),y)$p.value,5))
y
sapply(data_num, function(x) round(cor(as.numeric(x),y),5))
sapply(data_num, function(x) round(cor.test(x,y)$p.value,5))
sapply(data_num, function(x) round(cor(x,y),5))
sapply(data_num, function(x) round(cor.test(x,y)$p.value,5))
cor(numericas_tratado, use = 'everything')
correlation_matrix = cor(numericas_tratado,use = 'complete.obs')
num_vars_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$correlacionadas
num_vars_not_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$nao_correlacionadas %>% unlist
num_names_ordered = sapply(num_vars_correlated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_correlated = find_list_enough_vars_correlated(num_vars_correlated[num_names_ordered])
enough_vars_correlated
numericas_tratado = na.omit(numericas[-1])
correlation_matrix = cor(numericas_tratado,use = 'everything')
num_vars_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$correlacionadas
num_vars_not_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$nao_correlacionadas %>% unlist
num_names_ordered = sapply(num_vars_correlated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_correlated = find_list_enough_vars_correlated(num_vars_correlated[num_names_ordered])
enough_vars_correlated
numericas_tratado = na.omit(numericas[-1])
correlation_matrix = cor(numericas_tratado)
num_vars_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$correlacionadas
num_vars_not_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$nao_correlacionadas %>% unlist
num_names_ordered = sapply(num_vars_correlated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_correlated = find_list_enough_vars_correlated(num_vars_correlated[num_names_ordered])
enough_vars_correlated
T
T = TRUE
matrix_coef_contigency = calcule_multiple_coef_contigency(categoricas)
cat_vars_associated = part_variables_by_correlation(matrix_coef_contigency, valor_coef)$correlacionadas
cat_vars_not_associated = part_variables_by_correlation(matrix_coef_contigency, valor_coef)$nao_correlacionadas %>% unlist
cat_names_ordered = sapply(cat_vars_associated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_associated = find_list_enough_vars_correlated(cat_vars_associated[cat_names_ordered])
numericas_tratado = na.omit(numericas[-1])
correlation_matrix = cor(numericas_tratado)
num_vars_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$correlacionadas
num_vars_not_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$nao_correlacionadas %>% unlist
num_names_ordered = sapply(num_vars_correlated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_correlated = find_list_enough_vars_correlated(num_vars_correlated[num_names_ordered])
enough_vars_correlated
numericas_tratado = na.omit(numericas[-1])
correlation_matrix = cor(numericas_tratado, use = 'everything')
num_vars_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$correlacionadas
num_vars_not_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$nao_correlacionadas %>% unlist
num_names_ordered = sapply(num_vars_correlated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_correlated = find_list_enough_vars_correlated(num_vars_correlated[num_names_ordered])
enough_vars_correlated
numericas_tratado = na.omit(numericas[-1])
correlation_matrix = cor(numericas_tratado, use = 'complete.obs')
num_vars_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$correlacionadas
num_vars_not_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$nao_correlacionadas %>% unlist
num_names_ordered = sapply(num_vars_correlated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_correlated = find_list_enough_vars_correlated(num_vars_correlated[num_names_ordered])
enough_vars_correlated
sapply(data_num, function(x) round(cor(x,y, use = 'complete.obs'),5))
sapply(data_num, function(x) round(cor.test(x,y)$p.value,5))
sapply(data_num, function(x) round(cor(x,y, use = 'complete.obs'),5))
sapply(data_num, function(x) round(cor.test(x,y)$p.value,5))
result_cor_test = sapply(data_num, function(x) round(cor.test(x,y)$p.value,5))
result_cor_test
data_num[result_cor_test < 0.05]
signif_num_vars = data_num[result_cor_test < 0.05] %>% colnames()
signif_num_vars
result_cor_test
length(signif_num_vars)
length(result_cor_test)
length(signif_num_vars)
vec_num_vars_utils = c(enough_vars_correlated, num_vars_not_correlated)
vec_cat_vars_utils = c(enough_vars_associated, cat_vars_not_associated)
df_treino %>%
select(enough_vars_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(num_vars_not_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
data_num = cbind(df_treino[vec_num_vars_utils])
sapply(data_num, function(x) round(cor(x,y, use = 'complete.obs'),5))
result_cor_test = sapply(data_num, function(x) round(cor.test(x,y)$p.value,5))
result_cor_test
signif_num_vars = data_num[result_cor_test < 0.05] %>% colnames()
signif_num_vars
length(result_cor_test)
length(signif_num_vars)
cbind(df_treino[vec_cat_vars_utils],y)
data_cat = cbind(df_treino[vec_cat_vars_utils],y)
result_anova = summary(aov(y ~ ., data = data_cat))
result_anova
data_cat = cbind(df_treino[vec_cat_vars_utils],y)
result_anova = summary(aov(y ~ ., data = data_cat))
result_anova
result_anova = result_anova[[1]]
signif_cat_vars = result_anova[result_anova$`Pr(>F)` < 0.05,]
signif_cat_vars
signif_cat_vars
signif_cat_vars = result_anova[result_anova$`Pr(>F)` < 0.05,] %>% row.names %>% str_trim()
signif_cat_vars
length(row.names(result_anova))
length(signif_cat_vars)
knitr::opts_chunk$set(echo = F, message = F)
setwd('D:/pibic/src')
pacman::p_load('tidyverse','DescTools')
source('./utils/handle_data.R')
options(scipen=999)
#Retirando essas variáveis dos bancos de dados pois elas apresentavam muitos valores faltantes
#na hora das análises e os valores que restavam não influenciava muito na variável resposta
df_treino = read.csv('../data/train.csv') %>%
dplyr::select(!c(Alley,PoolQC,Fence,MiscFeature))
df_test = read.csv('../data/test.csv') %>%
dplyr::select(!c(Alley,PoolQC,Fence,MiscFeature))
y = df_treino$SalePrice
df_treino = df_treino %>%
dplyr::select(!c(SalePrice))
col_num = sapply(df_treino, typeof) == "integer"
col_char = sapply(df_treino, typeof) == "character"
numericas = df_treino[col_num]
categoricas = df_treino[col_char]
pseudo_vars_numericas = c("BsmtHalfBath","BsmtFullBath","FullBath","HalfBath","BedroomAbvGr","KitchenAbvGr","Fireplaces")
numericas = numericas %>%
select(!pseudo_vars_numericas)
categoricas = cbind(categoricas, df_treino[pseudo_vars_numericas])
categoricas[pseudo_vars_numericas] = sapply(categoricas[pseudo_vars_numericas], as.factor)
valor_coef = 0.5
numericas_tratado = na.omit(numericas[-1])
correlation_matrix = cor(numericas_tratado, use = 'complete.obs')
num_vars_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$correlacionadas
num_vars_not_correlated = part_variables_by_correlation(correlation_matrix, valor_coef)$nao_correlacionadas %>% unlist
num_names_ordered = sapply(num_vars_correlated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_correlated = find_list_enough_vars_correlated(num_vars_correlated[num_names_ordered])
matrix_coef_contigency = calcule_multiple_coef_contigency(categoricas)
cat_vars_associated = part_variables_by_correlation(matrix_coef_contigency, valor_coef)$correlacionadas
cat_vars_not_associated = part_variables_by_correlation(matrix_coef_contigency, valor_coef)$nao_correlacionadas %>% unlist
cat_names_ordered = sapply(cat_vars_associated, function(x) length(x)) %>% sort(decreasing = T) %>% names
enough_vars_associated = find_list_enough_vars_correlated(cat_vars_associated[cat_names_ordered])
vec_enough_vars_associated_or_correlated = c(enough_vars_associated,enough_vars_correlated)
vec_vars_not_associated_or_correlated = c(cat_vars_not_associated, num_vars_not_correlated)
vec_util_vars = c(vec_vars_not_associated_or_correlated, vec_enough_vars_associated_or_correlated)
vec_num_vars_utils = c(enough_vars_correlated, num_vars_not_correlated)
vec_cat_vars_utils = c(enough_vars_associated, cat_vars_not_associated)
df_treino %>%
select(enough_vars_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(num_vars_not_correlated) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_point()+
facet_wrap(~name, scales = 'free')
data_num = cbind(df_treino[vec_num_vars_utils])
sapply(data_num, function(x) round(cor(x,y, use = 'complete.obs'),5))
result_cor_test = sapply(data_num, function(x) round(cor.test(x,y)$p.value,5))
result_cor_test
signif_num_vars = data_num[result_cor_test < 0.05] %>% colnames()
signif_num_vars
length(result_cor_test)
length(signif_num_vars)
vec_cat_vars_utils = c(enough_vars_associated, cat_vars_not_associated)
df_treino %>%
select(enough_vars_associated[6:10]) %>%
cbind(y) %>%
mutate(KitchenAbvGr = as.character(KitchenAbvGr)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(cat_vars_not_associated[1:6]) %>%
cbind(y) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
df_treino %>%
select(cat_vars_not_associated[7:11]) %>%
cbind(y) %>%
mutate(Fireplaces = as.character(Fireplaces)) %>%
pivot_longer(-y) %>%
ggplot(aes(x = value, y = y))+
geom_boxplot()+
facet_wrap(~name, scales = 'free')
data_cat = cbind(df_treino[vec_cat_vars_utils],y)
result_anova = summary(aov(y ~ ., data = data_cat))
result_anova
result_anova = result_anova[[1]]
signif_cat_vars = result_anova[result_anova$`Pr(>F)` < 0.05,] %>% row.names %>% str_trim()
signif_cat_vars
length(signif_cat_vars)
length(row.names(result_anova))
vec_util_vars = c(vec_vars_not_associated_or_correlated, vec_enough_vars_associated_or_correlated)
vec_util_vars
knitr::opts_chunk$set(echo = F, message = F)
source('./tratamento_vars.Rmd')
source('./modelagem.Rmd')
source('./modelagem.R')
source('./modelagem.Rmd')
na.omit(signif_cat_vars)
result_anova[result_anova$`Pr(>F)` < 0.05,] %>%
row.names %>% str_trim() %>%
str_remove('NA')
